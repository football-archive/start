---
// src/pages/index.astro
import BaseLayout from "../layouts/BaseLayout.astro";

import { loadCallups } from "../lib/callups";
import { loadClubSquads } from "../lib/clubSquads";
import { loadLeagueMaster } from "../lib/leagueMaster";
import { loadClubMaster } from "../lib/clubMaster";
import { loadUpdates } from "../lib/updates";
import {
  clubsListUrl,
  tournamentTopUrl,
  DEFAULTS,
  competitionSeasonUrl,
} from "../lib/urls";
import { getUclSeasons, loadUclLeaguePhaseBySeason } from "../lib/ucl";
import { loadTransfers } from "../lib/transfers";

const wcYear = String(DEFAULTS.currentWcYear); // æœ€æ–°å¤§ä¼šã®YYYY

// yyyy-mm-dd ã®æœ€å¤§å€¤ã‚’è¿”ã™ï¼ˆç©ºãªã‚‰ nullï¼‰
const maxYmd = (rows: any[], key: string) => {
  let max: string | null = null;
  for (const r of rows) {
    const v = r?.[key];
    if (!v) continue;
    const s = String(v);
    if (!max || s > max) max = s;
  }
  return max;
};

// è¡¨ç¤ºç”¨ï¼ˆyyyy/mm/ddï¼‰
const ymdToJa = (ymd: any) => (ymd ? String(ymd).replaceAll("-", "/") : "â€”");

// --------------------
// æ›´æ–°æƒ…å ±
// --------------------
const updates = loadUpdates(6);

// --------------------
// ä»£è¡¨ï¼ˆWC2026 / æ—¥æœ¬ï¼‰
// --------------------
const callupsAll = loadCallups();
const callupsWc = callupsAll.filter(
  (r: any) => r.competition === "WC" && String(r.edition) === wcYear,
);

const japanHref = `/wc/${wcYear}/team/æ—¥æœ¬`;
const japanNames = new Set(["æ—¥æœ¬", "æ—¥æœ¬ä»£è¡¨", "Japan"]);
const callupsJapan = callupsWc.filter((r: any) =>
  japanNames.has(String(r.country ?? "").trim()),
);
const japanUpdatedAt = ymdToJa(maxYmd(callupsJapan, "snapshot_date"));

const wcUpdatedAt = ymdToJa(maxYmd(callupsWc, "snapshot_date"));

// ãƒãƒ¼ãƒ æ•°ï¼šcountry ã§ distinctï¼ˆç©ºã¯é™¤å¤–ï¼‰
const wcTeamCount = new Set(
  callupsWc.map((r: any) => String(r.country ?? "").trim()).filter(Boolean),
).size;

// äººæ•°ï¼šè¡Œæ•°ï¼ˆä»Šã®CSVæ§‹é€ ã ã¨ã€Œé¸æ‰‹1è¡Œã€ãªã®ã§ length ã§OKï¼‰
const wcPlayerCount = callupsWc.length;

// --------------------
// ã‚¯ãƒ©ãƒ–ï¼ˆå…¬é–‹ãƒªãƒ¼ã‚°Ã—å…¬é–‹ã‚¯ãƒ©ãƒ–ã€æœ€æ–°ã ã‘é›†è¨ˆï¼‰
// --------------------
const leagueShortcuts = [
  { label: "ãƒ—ãƒ¬ãƒŸã‚¢ãƒªãƒ¼ã‚°", league: "premier-league" },
  { label: "ãƒ©ãƒ»ãƒªãƒ¼ã‚¬", league: "laliga" },
  { label: "ãƒ–ãƒ³ãƒ‡ã‚¹ãƒªãƒ¼ã‚¬", league: "bundesliga" },
  { label: "ã‚»ãƒªã‚¨A", league: "serie-a" },
  { label: "ãƒªãƒ¼ã‚°ãƒ»ã‚¢ãƒ³", league: "ligue-1" },
  { label: "ã‚¨ãƒ¼ãƒ«ãƒ‡ã‚£ãƒ´ã‚£ã‚¸", league: "eredivisie" },
];

// âœ… is_publicã®å‹ãƒ–ãƒ¬å¸å
const isTrue = (v: any) => {
  if (typeof v === "boolean") return v;
  const s = String(v ?? "")
    .trim()
    .toLowerCase();
  return s === "true" || s === "1" || s === "yes" || s === "y" || s === "t";
};

// league_key æ­£è¦åŒ–ï¼ˆ/clubs ã¨åŒã˜æ€æƒ³ï¼‰
const leagueMasterRows = loadLeagueMaster();
const leagueAliasToKey = new Map<string, string>();
for (const l of leagueMasterRows as any[]) {
  const key = String(l.league_key ?? "").trim();
  if (!key) continue;
  const aliases = [
    l.league_key,
    l.league,
    l.league_display_ja,
    l.league_display_en,
  ];
  for (const a of aliases) {
    const s = String(a ?? "").trim();
    if (!s) continue;
    leagueAliasToKey.set(s, key);
    leagueAliasToKey.set(s.toLowerCase(), key);
  }
}
function normalizeLeagueKey(v: any): string {
  const s = String(v ?? "").trim();
  if (!s) return "";
  return leagueAliasToKey.get(s) ?? leagueAliasToKey.get(s.toLowerCase()) ?? s;
}

// å…¬é–‹ãƒªãƒ¼ã‚°ï¼ˆæ­£è¦åŒ–å¾Œã‚­ãƒ¼ï¼‰
const publicLeagueKeys = new Set(
  (leagueMasterRows as any[])
    .filter((l) => isTrue(l.is_public))
    .map((l) => normalizeLeagueKey(l.league_key)),
);

// å…¬é–‹ã‚¯ãƒ©ãƒ–ï¼ˆinactive / is_public=false ã‚’é™¤å¤–ï¼‰
const clubMasterRows = loadClubMaster();
const publicClubKeys = new Set(
  (clubMasterRows as any[])
    .filter((c) => {
      if ((c.status ?? "active") === "inactive") return false;
      if (!isTrue(c.is_public ?? true)) return false;
      return true;
    })
    .map((c) => String(c.club_key ?? "").trim())
    .filter(Boolean),
);

const clubRowsAll = loadClubSquads();

// å…¬é–‹ãƒªãƒ¼ã‚° Ã— å…¬é–‹ã‚¯ãƒ©ãƒ–ã®è¡Œã ã‘
const clubRowsPublic = clubRowsAll.filter((r: any) => {
  const lk = normalizeLeagueKey(r.league_key ?? r.league);
  const ck = String(r.club_key ?? "").trim();
  if (!lk || !ck) return false;
  if (!publicLeagueKeys.has(lk)) return false;
  if (!publicClubKeys.has(ck)) return false;
  return true;
});

function seasonStartYear(season: any): number {
  const s = String(season ?? "").trim();
  const m = s.match(/(\d{4})/);
  return m ? Number(m[1]) : 0;
}
function windowRank(w: any): number {
  const s = String(w ?? "")
    .trim()
    .toLowerCase();
  return s === "winter" ? 2 : 1; // summer or empty
}

type LatestMeta = { season: string; window: string; snapshot_date: string };

function isNewerMeta(a: LatestMeta, b: LatestMeta): boolean {
  const ay = seasonStartYear(a.season);
  const by = seasonStartYear(b.season);
  if (ay !== by) return ay > by;

  const aw = windowRank(a.window);
  const bw = windowRank(b.window);
  if (aw !== bw) return aw > bw;

  return String(a.snapshot_date ?? "") > String(b.snapshot_date ?? "");
}

const clubKeyOf = (r: any) =>
  `${normalizeLeagueKey(r.league_key ?? r.league)}__${String(r.club_key ?? "").trim()}`;

const clubLatestMeta = new Map<string, LatestMeta>();
for (const r of clubRowsPublic) {
  const k = clubKeyOf(r);
  if (!k) continue;

  const meta: LatestMeta = {
    season: String(r.season ?? "").trim(),
    window: String(r.window ?? "")
      .trim()
      .toLowerCase(),
    snapshot_date: String(r.snapshot_date ?? "").trim(),
  };

  if (meta.window !== "summer" && meta.window !== "winter") meta.window = "";
  if (!meta.snapshot_date) continue;

  const prev = clubLatestMeta.get(k);
  if (!prev || isNewerMeta(meta, prev)) clubLatestMeta.set(k, meta);
}

const clubRowsPublicLatest = clubRowsPublic.filter((r: any) => {
  const k = clubKeyOf(r);
  const latest = clubLatestMeta.get(k);
  if (!latest) return false;

  const meta: LatestMeta = {
    season: String(r.season ?? "").trim(),
    window: String(r.window ?? "")
      .trim()
      .toLowerCase(),
    snapshot_date: String(r.snapshot_date ?? "").trim(),
  };
  if (meta.window !== "summer" && meta.window !== "winter") meta.window = "";

  return (
    meta.season === latest.season &&
    meta.window === latest.window &&
    meta.snapshot_date === latest.snapshot_date
  );
});

const clubsLeagueCount = new Set(
  clubRowsPublicLatest.map((r: any) =>
    normalizeLeagueKey(r.league_key ?? r.league),
  ),
).size;

const clubsClubCount = clubLatestMeta.size;
const clubsPlayerCount = clubRowsPublicLatest.length;

const clubSnapMax =
  clubLatestMeta.size > 0
    ? Array.from(clubLatestMeta.values())
        .map((m) => m.snapshot_date)
        .reduce((a, b) => (a > b ? a : b))
    : null;

const updatedAtClub = ymdToJa(clubSnapMax);

const leaguesInData = new Set(
  clubRowsPublicLatest.map((r: any) =>
    normalizeLeagueKey(r.league_key ?? r.league),
  ),
);

const leagueShortcutsVisible = leagueShortcuts.filter(
  (x) => publicLeagueKeys.has(x.league) && leaguesInData.has(x.league),
);

const leagueHref = (leagueKey: string) => clubsListUrl({ leagueKey });

// --------------------
// UCL
// --------------------
const uclSeasons = getUclSeasons();
const uclSeason = uclSeasons?.[0] ? String(uclSeasons[0]).trim() : "2025-26";
const uclHref = competitionSeasonUrl("ucl", uclSeason);
const uclRows = loadUclLeaguePhaseBySeason(uclSeason);
const uclUpdatedAt = uclRows?.[0]?.updated_at
  ? String(uclRows[0].updated_at).replaceAll("-", "/")
  : "â€”";
const uclClubCount = uclRows?.length ?? 0;

// --------------------
// Transfers
// --------------------
const transfersAll = loadTransfers();
const transfersUpdatedAt = ymdToJa(maxYmd(transfersAll, "date_iso"));

// WC Topï¼ˆãƒªãƒ³ã‚¯ã«å¿…è¦ãªå ´åˆç”¨ã€‚ç¾çŠ¶ index ã§ã¯æœªä½¿ç”¨ã§ã‚‚OKï¼‰
const wcTopHref = tournamentTopUrl({
  tournament: DEFAULTS.currentWcTournament,
  year: DEFAULTS.currentWcYear,
});
---

<BaseLayout
  title="World Football Archiveï½œæµ·å¤–ã‚µãƒƒã‚«ãƒ¼DB"
  bodyClass="page-home"
  description="Wikiã‚ˆã‚Šã‚µãƒƒã¨è¦‹ã‚Œã¦ã€Transfermarktã‚ˆã‚Šè»½å¿«ã€‚ãƒ‹ãƒ¥ãƒ¼ã‚¹ã‚’è¿½ã†ã‚ˆã‚Šã€å…¨ä½“ãŒä¸€ç›®ã§ã‚ã‹ã‚‹ã€‚ FIFAãƒ¯ãƒ¼ãƒ«ãƒ‰ã‚«ãƒƒãƒ—ã®ä»£è¡¨ãƒãƒ¼ãƒ ã‚„ã€æµ·å¤–ã‚¯ãƒ©ãƒ–ç™»éŒ²ãƒ¡ãƒ³ãƒãƒ¼ã®ã€ä»Š / ã‚ã®æ™‚ã€ã‚’è¡Œãæ¥ã™ã‚‹ã€ã€ä¸–ç•Œã‚µãƒƒã‚«ãƒ¼DBã€ã€‚"
  bodyStyle="margin:0; background:#fafafa; color:#111;"
>
  <style is:global>
    :root {
      --border: #e6e6e6;
      --muted: #666;
      --bg: #fafafa;
      --date-red: #e11d48;
    }

    /* ==========================
       Layout
    ========================== */
    .container {
      max-width: var(--container-max);
      margin: 0 auto;
      padding: 12px var(--container-pad) 48px;
    }
    .hero {
      background: #fff;
      border: 1px solid var(--border);
      border-radius: 14px;
      padding: 14px 18px;
    }
    .subtitle {
      margin: 0;
      color: var(--muted);
      line-height: 1.6;
    }

    /* 2åˆ—Ã—3è¡Œï¼ˆPCï¼‰ */
    .grid {
      display: grid;
      grid-template-columns: 1fr;
      gap: 12px;
      margin-top: 12px;
    }
    @media (min-width: 760px) {
      .grid {
        grid-template-columns: 1fr 1fr;
        grid-template-rows: auto auto auto;
        column-gap: 12px;
        row-gap: 12px;
        align-items: stretch;
      }
      .grid-nt-main {
        grid-column: 1;
        grid-row: 1;
      }
      .grid-club-main {
        grid-column: 2;
        grid-row: 1;
      }
      .grid-nt-sub1 {
        grid-column: 1;
        grid-row: 2;
      }
      .grid-club-sub1 {
        grid-column: 2;
        grid-row: 2;
      }
      .grid-nt-sub2 {
        grid-column: 1;
        grid-row: 3;
      }
      .grid-club-sub2 {
        grid-column: 2;
        grid-row: 3;
      }
    }

    /* ==========================
       Common UI
    ========================== */
    .date-red {
      color: var(--date-red);
      font-weight: 700;
    }

    .updates {
      margin-top: 10px;
      padding: 12px 14px;
      border: 1px solid var(--border);
      border-radius: 14px;
      background: #fff;
    }
    .updates h2 {
      margin: 0 0 6px;
      font-size: 15px;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .updates ul {
      margin: 0;
      padding-left: 16px;
    }
    .updates li {
      margin: 4px 0;
      line-height: 1.5;
      font-size: 12.5px;
    }
    .updates .date {
      display: inline-block;
      min-width: 86px;
      color: var(--date-red);
      font-variant-numeric: tabular-nums;
      margin-right: 8px;
      font-size: 13px;
      font-weight: 700;
    }
    .updates .title {
      font-weight: 400;
      font-size: 14px;
    }

    .quick-title {
      margin: 0;
      font-size: 13px;
      color: var(--muted);
    }

    .pills {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
    }
    .pill {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 7px 10px;
      border-radius: 999px;
      border: 1px solid var(--border);
      background: #fff;
      color: #111;
      text-decoration: none;
      font-size: 13px;
      line-height: 1;
      transition:
        transform 0.06s ease,
        box-shadow 0.06s ease;
    }
    .pill:hover {
      transform: translateY(-1px);
      box-shadow: 0 6px 18px rgba(0, 0, 0, 0.06);
    }
    .pill .dot {
      width: 7px;
      height: 7px;
      border-radius: 999px;
      background: #111;
      opacity: 0.35;
    }

    .see-now {
      font-size: 13px;
      color: #111;
      text-decoration: none;
      white-space: nowrap;
    }
    .see-now:hover {
      text-decoration: underline;
    }

    .badge {
      font-size: 12px;
      color: #222;
      border: 1px solid var(--border);
      padding: 3px 8px;
      border-radius: 999px;
      background: #fff;
      white-space: nowrap;
    }

    /* ==========================
       Cards (main)
    ========================== */
    .card {
      background: var(--theme-soft-bg);
      border: 2px solid var(--theme-soft-border);
      border-radius: 14px;
      padding: 16px;
      color: inherit;
      display: block;
      transition:
        transform 0.06s ease,
        box-shadow 0.06s ease;
      cursor: default;
    }
    .card:hover {
      transform: translateY(-1px);
      box-shadow: 0 6px 18px rgba(0, 0, 0, 0.06);
    }

    .card-title {
      display: flex;
      align-items: baseline;
      justify-content: space-between;
      gap: 10px;
      margin: 0 0 6px;
      flex-wrap: wrap;
    }

    /* âœ… ã‚¿ã‚¤ãƒˆãƒ«çµ±ä¸€ï¼ˆWC/ã‚¯ãƒ©ãƒ–/ã‚µãƒ–ã™ã¹ã¦ 18pxï¼‰ */
    body.page-home .card h2,
    body.page-home .subcard-title {
      font-size: 18px;
      font-weight: 800;
      margin: 0 0 8px;
      line-height: 1.25;
    }

    .card-desc {
      margin: 0;
      color: #555;
      line-height: 1.6;
    }
    .card-meta {
      margin-top: 10px;
      color: var(--muted);
      font-size: 12px;
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
    }
    /* â€œç·šã®ä¸‹ã«ä½™ç™½â€ãŒæ¬²ã—ã‘ã‚Œã°ã€ç·šã®æ¬¡ã®ãƒ–ãƒ­ãƒƒã‚¯ã«margin-topã‚’ä»˜ã‘ã‚‹ */
    .card-portal .portal-links,
    .card-club .card-shortcuts {
      margin-top: 12px;
    }
    .card-shortcuts {
      border-top: none;
      padding-top: 0;
    }
    .shortcut-head {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
      margin: 0 0 10px;
      flex-wrap: wrap;
    }

    /* ==========================
       ã‚«ãƒ¼ãƒ‰ä¸Šéƒ¨é«˜ã•çµ±ä¸€
    ========================== */
    .card-head {
      min-height: 72px; /* â†ã“ã“ã§é«˜ã•çµ±ä¸€ */
      display: flex;
      flex-direction: column;
      justify-content: space-between;
    }

    /* è¡Œé–“ã‚’æƒãˆã‚‹ */
    .card-head p {
      margin: 0;
      line-height: 1.45;
    }

    /* meta è¡Œã‚‚æƒãˆã‚‹ */
    .card-head .card-meta {
      margin-top: 6px;
    }

    /* ==========================
       WC portal (dark face)
    ========================== */
    .card-portal {
      color: #fff;
      border-color: color-mix(in srgb, var(--theme-color) 70%, #111);
      background: linear-gradient(
        135deg,
        color-mix(in srgb, var(--theme-color) 85%, #000),
        color-mix(in srgb, var(--theme-color) 75%, #ffffff)
      );
      border-radius: 14px;
      padding: 20px;
    }
    .card-portal h2 {
      margin: 0 0 12px;
      font-size: 1.3rem; /* è¦‹å‡ºã—ã®å­˜åœ¨æ„Ÿã ã‘ã¯WCãƒãƒ¼ã‚¿ãƒ«ç‰¹åˆ¥ */
    }

    /* ã‚¿ã‚¤ãƒˆãƒ«ä¸‹ã®ä½™ç™½ã‚’çµ±ä¸€ï¼ˆã“ã“ãŒåŠ¹ãï¼‰ */
    .page-home .card-h2 {
      display: flex;
      align-items: center;
      gap: 8px;
      margin: 0 0 6px; /* â†ã“ã“ãŒâ€œç©ºãã™ãâ€ã®æœ¬ä¸¸ */
    }

    .page-home .card-ico {
      display: inline-flex;
      width: 22px;
      justify-content: center;
    }

    /* ==========================
       ã‚«ãƒ¼ãƒ‰ä¸Šéƒ¨é«˜ã•ï¼ˆã‚«ãƒ¼ãƒ‰åˆ¥ã«çµ±ä¸€ï¼‰
    ========================== */
    .card-head {
      display: flex;
      flex-direction: column;
      justify-content: space-between;
    }
    .card-portal .card-head {
      min-height: 72px;
    }
    .card-club .card-head {
      min-height: 76px;
    } /* ã¾ãšã¯åŒå€¤ã§æƒãˆã‚‹ */

    /* è¡Œé–“ã‚’æƒãˆã‚‹ */
    .card-head p {
      margin: 0;
      line-height: 1.45;
    }
    .card-head .card-meta {
      margin-top: 6px;
    }

    /* åŒºåˆ‡ã‚Šç·šã¯ card-sep 1æœ¬ã«çµ±ä¸€ */
    .card-sep {
      margin-top: 10px;
      border-top: 1px dashed var(--border);
    }

    /* WCå†…ã®metaã¯ç™½å¯„ã›ï¼ˆâ€»ç·šã¯æŒãŸã›ãªã„ï¼‰ */
    .card-portal .card-meta {
      color: rgba(255, 255, 255, 0.88);
      padding-bottom: 0;
      margin-bottom: 0;
      border: none;
    }
    .card-portal .card-meta .date-red {
      color: #ffd400;
      font-weight: 800;
    }

    .card-portal .card-meta .date-red {
      color: #ffd400; /* WCã®ä¸­ã§ã¯èµ¤ã‚ˆã‚Šé»„ãŒè¦–èªæ€§é«˜ã„ */
      font-weight: 800;
    }

    .card-portal .card-meta .badge {
      background: rgba(255, 255, 255, 0.12);
      color: rgba(255, 255, 255, 0.92);
      border-color: rgba(255, 255, 255, 0.25);
    }
    .portal-links {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
    }
    .portal-btn {
      background: rgba(255, 255, 255, 0.15);
      padding: 8px 14px;
      border-radius: 999px;
      text-decoration: none;
      color: #fff;
      font-size: 0.9rem;
      transition: 0.2s;
    }
    .portal-btn:hover {
      background: rgba(255, 255, 255, 0.3);
    }
    .portal-main {
      background: #fff;
      color: #111;
      font-weight: bold;
    }

    /* ==========================
       Subcards
    ========================== */
    .subcard {
      background: var(--theme-soft-bg);
      border: 1px solid var(--theme-soft-border);
      border-radius: 14px;
      padding: 16px;

      /* ã‚µãƒ–ã‚«ãƒ¼ãƒ‰ã¯å°‘ã—æ¿ƒã„ç›®ã«ï¼ˆå·®ãŒå‡ºã‚‹ã‚ˆã†ã«ï¼‰ */
      --theme-soft-bg: color-mix(in srgb, var(--theme-color) 28%, #ffffff);
      --theme-soft-border: color-mix(
        in srgb,
        var(--theme-color) 48%,
        var(--border)
      );
    }

    /* âœ… ã‚¿ã‚¤ãƒˆãƒ«ã¯ h3 + a ã§çµ±ä¸€ï¼ˆä¸‹ç·šã¯å¿…è¦ãªã®ã§æ¨™æº–ã§ONï¼‰ */
    .subcard-title a {
      color: inherit;
      text-decoration: underline;
      text-underline-offset: 2px;
    }

    /* è£œåŠ©æ–‡ */
    .ucl-sub,
    .jp-sub,
    .transfer-sub,
    .euro-sub {
      margin-top: 6px;
      font-size: 12px;
      line-height: 1.5;
      color: var(--muted);
    }

    /* EUROï¼ˆãƒªãƒ³ã‚¯ç„¡ã—ï¼‰ã‚‚åŒã˜è¦‹ãŸç›®ã«ã™ã‚‹ãŸã‚ã€ã‚¿ã‚¤ãƒˆãƒ«ç”¨ã‚¯ãƒ©ã‚¹ã‚’å»ƒæ­¢ã—ã¦ subcard-title ã«å¯„ã›ã‚‹ */
    /* â€»HTMLå´ã§ subcard-title ã®ä¸­èº«ã‚’å˜ãªã‚‹ãƒ†ã‚­ã‚¹ãƒˆã«ã—ã¦OK */

    /* ==========================
       Dark subcards (UCL / Japan)
    ========================== */
    .subcard.theme-ucl,
    .subcard.theme-japan {
      color: #fff;
      border-color: rgba(0, 0, 0, 0.25);
      /* ã‚‚ã†ä¸€æ®µæ¿ƒã */
      --theme-soft-bg: color-mix(in srgb, var(--theme-color) 70%, #ffffff);
      --theme-soft-border: color-mix(
        in srgb,
        var(--theme-color) 88%,
        var(--border)
      );
    }
    .subcard.theme-ucl .ucl-sub,
    .subcard.theme-japan .jp-sub {
      color: rgba(255, 255, 255, 0.85);
    }
    /* æ¿ƒè‰²ã‚«ãƒ¼ãƒ‰å†…ãƒªãƒ³ã‚¯ã®ä¸‹ç·šè‰² */
    .subcard.theme-ucl .subcard-title a,
    .subcard.theme-japan .subcard-title a {
      text-decoration-color: rgba(255, 255, 255, 0.75);
    }
    .subcard.theme-ucl .subcard-title a:hover,
    .subcard.theme-japan .subcard-title a:hover {
      text-decoration-color: #fff;
    }

    /* Footer */
    .footer {
      margin-top: 18px;
      font-size: 12px;
      font-weight: 600;
      color: #111;
    }

    .jp-history {
      margin-top: 10px;
    }

    .jp-history a {
      display: inline-block;
      padding: 6px 12px;
      border-radius: 999px;
      background: rgba(255, 255, 255, 0.18);
      font-weight: 700;
      font-size: 13px;
      text-decoration: none;
      transition: 0.15s ease;
    }

    .jp-history a:hover {
      background: rgba(255, 255, 255, 0.28);
      transform: translateY(-1px);
    }

    .legend-btn {
      display: block;
      margin-top: 10px;
      padding: 10px;
      text-align: center;
      font-weight: 700;
      background: #ffd400;
      color: #000;
      border-radius: 8px;
      text-decoration: none;
    }

    /* æ—¥æœ¬ã‚«ãƒ¼ãƒ‰å†…ã§ã‚‚å¼·è±ªå›½ãƒœã‚¿ãƒ³ã¨åŒã˜è¦‹ãŸç›®ã«ã™ã‚‹ï¼ˆä¸Šæ›¸ãå„ªå…ˆï¼‰ */
    .jp-box .legend-btn {
      background: #ffd400;
      color: #111;
      border: 1px solid rgba(0, 0, 0, 0.12);
      text-decoration: none;
    }

    /* ã‚‚ã—é’ã‚«ãƒ¼ãƒ‰å´ã® a ã® padding / radius ãŒå´©ã™ãªã‚‰å¿µã®ãŸã‚å›ºå®š */
    .jp-box .legend-btn {
      background: #ffd400 !important;
      color: #111 !important;

      display: block;
      text-align: center;

      font-size: 16px; /* â† ã“ã“ãŒé‡è¦ */
      font-weight: 700; /* å¤ªã• */
      line-height: 1; /* é«˜ã•ãƒ–ãƒ¬é˜²æ­¢ */

      padding: 12px 16px; /* å¼·è±ªå›½ã¨åŒã˜ä½“æ„Ÿã‚µã‚¤ã‚º */
      border-radius: 10px;
    }
  </style>

  <div class="container">
    <div class="hero">
      <p class="subtitle">
        Wikiã‚ˆã‚Šã‚µãƒƒã¨è¦‹ã‚Œã¦ã€Transfermarktã‚ˆã‚Šè»½å¿«ã€‚ãƒ‹ãƒ¥ãƒ¼ã‚¹ã‚’è¿½ã†ã‚ˆã‚Šã€å…¨ä½“ãŒä¸€ç›®ã§ã‚ã‹ã‚‹ã€‚<br
        />
        FIFAãƒ¯ãƒ¼ãƒ«ãƒ‰ã‚«ãƒƒãƒ—ã®ä»£è¡¨ãƒãƒ¼ãƒ ã‚„ã€æµ·å¤–ã‚¯ãƒ©ãƒ–ç™»éŒ²ãƒ¡ãƒ³ãƒãƒ¼ã®ã€Œä»Š / ã‚ã®æ™‚ã€ã‚’è¡Œãæ¥ã™ã‚‹ã€ä¸–ç•Œã‚µãƒƒã‚«ãƒ¼DBã€‚
      </p>

      <section class="updates">
        <h2>ğŸ†• æ›´æ–°æƒ…å ±</h2>
        {
          updates.length === 0 ? (
            <p class="muted">æ›´æ–°æƒ…å ±ã¯æº–å‚™ä¸­ã§ã™ã€‚</p>
          ) : (
            <ul>
              {updates.map((u, i) => (
                <li class={i === 0 ? "is-latest" : ""}>
                  <span class="date">{u.date.replaceAll("-", "/")}</span>
                  <span class="title">{u.title}</span>
                </li>
              ))}
            </ul>
          )
        }
      </section>

      <div class="grid">
        <!-- ğŸ† WCãƒãƒ¼ã‚¿ãƒ«ã‚«ãƒ¼ãƒ‰ -->
        <div class="card card-portal theme-wc grid-nt-main">
          <h2 class="card-h2">ğŸ† FIFAãƒ¯ãƒ¼ãƒ«ãƒ‰ã‚«ãƒƒãƒ—2026</h2>
          <div class="card-head">
            <p class="wc-desc">
              ä»£è¡¨ãƒãƒ¼ãƒ ã®æœ€æ–°ãƒ¡ãƒ³ãƒãƒ¼ã€ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã¯ã‚³ãƒãƒ©ã‹ã‚‰ã€‚
            </p>
            <div class="card-meta">
              <span>ä»£è¡¨æ›´æ–°ï¼š<span class="date-red">{wcUpdatedAt}</span></span>
              <span>å‡ºå ´ï¼š{wcTeamCount}ãƒãƒ¼ãƒ  / {wcPlayerCount}äºº</span>
            </div>
          </div>
          <div class="card-sep" aria-hidden="true"></div>

          <div class="portal-links">
            <a href="/wc/2026/#teams" class="portal-btn"
              >å‡ºå ´å›½ãƒ»ä»£è¡¨ãƒ¡ãƒ³ãƒãƒ¼ä¸€è¦§</a
            >
            <a href="/wc/2026/#groups" class="portal-btn"
              >ã‚°ãƒ«ãƒ¼ãƒ—ãƒªãƒ¼ã‚°å‹æ•—è¡¨</a
            >
            <a href="/wc/2026/#rankings" class="portal-btn"
              >å¾—ç‚¹ãƒ»ã‚¢ã‚·ã‚¹ãƒˆãƒ©ãƒ³ã‚­ãƒ³ã‚°</a
            >
            <a href="/wc/2026/#schedule" class="portal-btn">è©¦åˆæ—¥ç¨‹ãƒ»çµæœ</a>
            <a href="/wc/2026/#awards" class="portal-btn portal-main">è¡¨å½°</a>
          </div>
          <a class="legend-btn" href="/nt/wc/legends">
            å¼·è±ªå›½ä»£è¡¨ã€€Wæ¯ã®ã‚ã‚†ã¿ï¼ˆæ­´ä»£ä»£è¡¨ãƒ¡ãƒ³ãƒãƒ¼ï¼‰
          </a>
        </div>

        <!-- row1 col2: CLUB main -->
        <div class="card card-club theme-club grid-club-main">
          <h2 class="card-h2">
            <span class="card-ico" aria-hidden="true">ğŸ‘•</span>
            2025-26 ä¸»è¦ã‚¯ãƒ©ãƒ– ç™»éŒ²ãƒ¡ãƒ³ãƒãƒ¼(ã‚¹ã‚«ãƒƒãƒ‰)
          </h2>
          <div class="card-head">
            <p class="card-desc">
              æœ€æ–°ã‚·ãƒ¼ã‚ºãƒ³ã®ç™»éŒ²é¸æ‰‹ã‚’ã€ã‚¯ãƒ©ãƒ–åˆ¥ãƒ»ãƒªãƒ¼ã‚°åˆ¥ã«ã€‚
            </p>
            <div class="card-meta">
              <span
                >ã‚¯ãƒ©ãƒ–æ›´æ–°ï¼š<span class="date-red">{updatedAtClub}</span></span
              >
              <span>
                ã‚¯ãƒ©ãƒ–ï¼š{clubsLeagueCount}ãƒªãƒ¼ã‚° / {clubsClubCount}ã‚¯ãƒ©ãƒ– / {
                  clubsPlayerCount
                }äºº
              </span>
            </div>
          </div>
          <div class="card-sep" aria-hidden="true"></div>

          <div class="card-shortcuts">
            <div class="shortcut-head">
              <p class="quick-title">ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆï¼šä¸»è¦ãƒªãƒ¼ã‚°ã‹ã‚‰æ¢ã™</p>
              <a class="see-now" href="/clubs">â†’ ã„ã¾ã™ãè¦‹ã‚‹</a>
            </div>

            <div class="pills">
              {
                leagueShortcutsVisible.map((x) => (
                  <a
                    class="pill"
                    href={leagueHref(x.league)}
                    aria-label={`${x.label} ã®ã‚¯ãƒ©ãƒ–ä¸€è¦§ã¸`}
                  >
                    <span class="dot" aria-hidden="true" />
                    {x.label}
                  </a>
                ))
              }
              <a class="pill" href="/clubs" aria-label="å…¨ãƒªãƒ¼ã‚°ã®ã‚¯ãƒ©ãƒ–ä¸€è¦§ã¸">
                <span class="dot" aria-hidden="true"></span>
                å…¨ãƒªãƒ¼ã‚°
              </a>
            </div>
          </div>
        </div>

        <!-- row2 col1: Japan -->
        <div class="subcard jp-box theme-japan grid-nt-sub1">
          <h3 class="subcard-title">
            <a href={japanHref}>SAMURAI BLUEï¼ˆæ—¥æœ¬ä»£è¡¨/ãƒ¯ãƒ¼ãƒ«ãƒ‰ã‚«ãƒƒãƒ—ï¼‰</a>
          </h3>

          <div class="jp-sub">
            æ—¥æœ¬ä»£è¡¨ã¯ã‚³ãƒãƒ©ã‹ã‚‰ï¼ˆWC2026ãƒ¡ãƒ³ãƒãƒ¼ä¸€è¦§ã¸ï¼‰<br />
            æ›´æ–°ï¼š<span class="date-red">{japanUpdatedAt}</span>
          </div>

          <!-- â˜…è¿½åŠ ï¼šæ­´ä»£WCå°ç·š -->
          <div class="jp-history">
            <a class="legend-btn" href="/nt/japan/wc"
              >æ—¥æœ¬ä»£è¡¨ã€€Wæ¯ã®ã‚ã‚†ã¿ï¼ˆæ­´ä»£ä»£è¡¨ãƒ¡ãƒ³ãƒãƒ¼ï¼‰</a
            >
          </div>
        </div>

        <!-- row2 col2: UCL -->
        <div class="subcard ucl-box theme-ucl grid-club-sub1">
          <h3 class="subcard-title">
            <a href={uclHref}
              >UEFAãƒãƒ£ãƒ³ãƒ”ã‚ªãƒ³ã‚ºãƒªãƒ¼ã‚°(CL) {uclSeason}ï¼ˆé †ä½è¡¨ï¼‰</a
            >
          </h3>
          <div class="ucl-sub">
            ãƒªãƒ¼ã‚°ãƒ•ã‚§ãƒ¼ã‚ºæœ€çµ‚é †ä½è¡¨ï¼ˆã‚¯ãƒ©ãƒ–è©³ç´°ã¸é·ç§»ã§ãã¾ã™ï¼‰<br />
            æ›´æ–°ï¼š<span class="date-red">{uclUpdatedAt}</span>ã€€å‚åŠ ï¼š{
              uclClubCount
            }ã‚¯ãƒ©ãƒ–
          </div>
        </div>

        <!-- row3 col1: EURO -->
        <div class="subcard euro-box theme-euro grid-nt-sub2">
          <h3 class="subcard-title">EURO 2028 äºˆé¸</h3>
          <div class="euro-sub">æº–å‚™ä¸­</div>
          <div class="euro-sub">
            æ›´æ–°ï¼š<span class="date-red">â€”</span>
          </div>
        </div>

        <!-- row3 col2: Transfers -->
        <div class="subcard transfer-box theme-club grid-club-sub2">
          <h3 class="subcard-title">
            <a href="/transfers">2025-26å†¬ ä¸»ãªç§»ç±ä¸€è¦§</a>
          </h3>
          <div class="transfer-sub">
            å†¬ã®ä¸»è¦é¸æ‰‹ã®ç§»ç±ã¯ã‚³ãƒãƒ©ã‹ã‚‰ä¸€è¦§ã§ï¼<br />
            æ›´æ–°ï¼š<span class="date-red">{transfersUpdatedAt}</span>
          </div>
        </div>
      </div>

      <div class="footer">
        â€» å„æ›´æ–°æ—¥ã¯ã€ä»£è¡¨ãƒ»ã‚¯ãƒ©ãƒ–ãã‚Œãã‚Œã®æœ€æ–°ãƒ‡ãƒ¼ã‚¿åæ˜ æ—¥ã‚’ç¤ºã—ã¦ã„ã¾ã™ã€‚
      </div>

      <div
        style="margin-top:28px; text-align:center; font-size:13px; color:#666;"
      >
        <a href="/about">World Football Archive ã«ã¤ã„ã¦ï¼ˆã“ã®ã‚µã‚¤ãƒˆã®æ¦‚è¦ï¼‰</a>
      </div>
    </div>
  </div>
</BaseLayout>
